# ๐ค ุฎุงุฏู MetaTrader 5 ุงููุณูุท (MT5 Middleware Server)

<div dir="rtl">

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงููุดุฑูุน ูููุฑ ุฎุงุฏู API ูุณูุท (Middleware) ูุนูู ูุฌุณุฑ ุจูู ุชุทุจููุงุช ุงูููุจ ุงูุฎุงุฑุฌูุฉ ูููุตุฉ MetaTrader 5 ููุชุฏุงูู ุงูุขูู.

### ๐ฏ ุงููุฏู ุงูุฑุฆูุณู

ุชูููู ูููุงุก ุงูุฐูุงุก ุงูุงุตุทูุงุนู (AI Agents) ูู ุงูุชุญูู ูู MT5 ุนุจุฑ ูุงุฌูุฉ REST API ุจุณูุทุฉ.

---

## ๐ ุฌุฏูุฏ: Cloud Sync - ุชุญูู ูู ุฃู ููุงู!

ุงูุขู ููููู ุงูุชุญูู ูู MT5 ูู ููุจุงููู ุฃู ุฃู ุฌูุงุฒ ุขุฎุฑ!

```
๐ฑ ููุจุงููู โโ โ๏ธ Claude AI โโ ๐ ngrok โโ ๐ป ุฌูุงุฒู โโ ๐ MT5
```

### ๐ ุงูุจุฏุก ุงูุณุฑูุน (ุถุบุทุฉ ูุงุญุฏุฉ!)

```bash
# 1. ุญููู ุงููุดุฑูุน
git clone https://github.com/Ahmedyassen77/ICT.git
cd ICT/mt5_middleware

# 2. ุดุบูู ุณูุฑุจุช ุงูุฅุนุฏุงุฏ ุงูุชููุงุฆู
python setup_cloud_sync.py

# 3. ุฃู ุนูู Windows - ุงููุฑ ูุฑุชูู ุนูู:
start_cloud_sync.bat
```

### ๐ ุงูุฃุฏูุฉ ุงููุชููุฑุฉ

| ุงูุฏููู | ุงููุตู |
|--------|-------|
| [CLOUD_SYNC_GUIDE.md](./CLOUD_SYNC_GUIDE.md) | ๐ ุฏููู Cloud Sync ุงููุงูู |
| [ULTIMATE_CONTROL_GUIDE.md](./ULTIMATE_CONTROL_GUIDE.md) | ๐ฎ ุฏููู ุงูุชุญูู ุงูุฐูู |
| [FULL_CONTROL_GUIDE.md](./FULL_CONTROL_GUIDE.md) | ๐ฑ๏ธ ุฏููู ุงูุชุญูู ุงููุงูู |
| [WINDOWS_SETUP_GUIDE.md](./WINDOWS_SETUP_GUIDE.md) | ๐ป ุฏููู ุฅุนุฏุงุฏ Windows |

---

## โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

| ุงูููุฒุฉ | ุงููุตู |
|--------|-------|
| ๐ **Cloud Sync** | ุชุญูู ูู ุฃู ููุงู ุนุจุฑ ุงูุฅูุชุฑูุช |
| ๐ค **ุฅูุดุงุก EA ุชููุงุฆู** | ุฅูุดุงุก Expert Advisor ุจุฃู ุงุณุชุฑุงุชูุฌูุฉ |
| ๐ **Backtest ูุฑุฆู** | ุงุฎุชุจุงุฑ ูุชุดุงูุฏ ุงููุชุงุฆุฌ ูุจุงุดุฑุฉ |
| ๐ ุฅุฏุงุฑุฉ ุงูุงุชุตุงู | ุงูุงุชุตุงู ููุทุน ุงูุงุชุตุงู ุจู MT5 |
| ๐ ุงููุณุชุดุงุฑูู ุงูุฎุจุฑุงุก | ุงุณุชุนุฑุงุถ ูุงุฆูุฉ EAs ุงููุชุงุญุฉ |
| ๐ฐ ูุนูููุงุช ุงูุญุณุงุจ | ุฌูุจ ุงูุฑุตูุฏ ูุงูุฃุฑุจุงุญ |
| ๐ ุฃูุงู ูุชูุฏู | API Key + CORS |

### ๐ฎ ุงูุฃูุธูุฉ ุงููุชููุฑุฉ

| ุงูููู | ุงููุตู | ุงูุงุณุชุฎุฏุงู |
|-------|-------|-----------|
| `setup_cloud_sync.py` | โญ ุณูุฑุจุช ุงูุฅุนุฏุงุฏ ุงูุชููุงุฆู | `python setup_cloud_sync.py` |
| `remote_control_server.py` | ุฎุงุฏู ุงูุชุญูู ุนู ุจุนุฏ | ููู Cloud Sync |
| `mt5_complete_automation.py` | ุงูุฃุชูุชุฉ ุงููุงููุฉ | ุฅูุดุงุก EA + Backtest |
| `mt5_ultimate_control.py` | ุงูุชุญูู ุงูุฐูู (pywinauto) | ุชุญูู ูุชูุฏู |
| `claude_gemini_bridge.py` | ุฌุณุฑ Claude-Gemini | ููุชูุงูู ูุน AI |

---

## ๐ ุงูุชุซุจูุช ูุงูุชุดุบูู

### ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

- Python 3.8 ุฃู ุฃุญุฏุซ
- MetaTrader 5 ูุซุจุช ุนูู Windows
- ุญุณุงุจ ุชุฏุงูู (ุญูููู ุฃู ุชุฌุฑูุจู)

### ุฎุทูุงุช ุงูุชุซุจูุช

#### 1๏ธโฃ ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ

```bash
# ุชุซุจูุช ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ
pip install fastapi uvicorn pydantic httpx

# ุชุซุจูุช ููุชุจุฉ MT5 (ุนูู Windows ููุท!)
pip install MetaTrader5
```

#### 2๏ธโฃ ุฃู ุงุณุชุฎุฏุงู ููู requirements.txt

```bash
pip install -r requirements.txt
pip install MetaTrader5  # ุนูู Windows ููุท
```

#### 3๏ธโฃ ุชุดุบูู ุงูุฎุงุฏู

```bash
# ุงูุทุฑููุฉ ุงูุฃููู
python main.py

# ุงูุทุฑููุฉ ุงูุซุงููุฉ
uvicorn main:app --reload --port 8000

# ุชุญุฏูุฏ ุงููููุฐ ูุงูุนููุงู
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

#### 4๏ธโฃ ุงููุตูู ููุชูุซูู

ุจุนุฏ ุชุดุบูู ุงูุฎุงุฏูุ ุงูุชุญ ุงููุชุตูุญ ุนูู:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

---

## ๐ก ููุงุท ุงูููุงูุฉ (API Endpoints)

### 1. ุงูุงุชุตุงู ุจู MT5

```http
POST /connect
Content-Type: application/json

{
    "terminal_path": "C:/Program Files/MetaTrader 5/terminal64.exe",
    "login": 12345678,
    "password": "your_password",
    "server": "YourBroker-Server"
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
    "success": true,
    "message": "ุชู ุงูุงุชุตุงู ุจู MT5 ุจูุฌุงุญ",
    "terminal_info": {
        "company": "MetaQuotes Software Corp.",
        "name": "MetaTrader 5",
        "build": 3815
    }
}
```

### 2. ูุทุน ุงูุงุชุตุงู

```http
POST /disconnect
```

### 3. ุชุดุบูู ุงุฎุชุจุงุฑ ุงูุงุณุชุฑุงุชูุฌูุฉ (โญ ุงูููุฒุฉ ุงูุฃูู)

```http
POST /run_backtest
Content-Type: application/json

{
    "terminal_path": "C:/Program Files/MetaTrader 5/terminal64.exe",
    "expert_advisor": "ExpertMACD",
    "symbol": "EURUSD",
    "period": "H1",
    "from_date": "2024.01.01",
    "to_date": "2024.06.30",
    "deposit": 10000,
    "leverage": 100,
    "model": 0,
    "optimization": 0,
    "visual": 0
}
```

### 4. ูุงุฆูุฉ ุงููุณุชุดุงุฑูู ุงูุฎุจุฑุงุก

```http
POST /list_experts
Content-Type: application/json

{
    "mql5_path": "C:/Users/USERNAME/AppData/Roaming/MetaQuotes/Terminal/XXXX/MQL5"
}
```

### 5. ูุนูููุงุช ุงูุญุณุงุจ

```http
GET /account_info
```

---

## ๐ง ุดุฑุญ ุขููุฉ Strategy Tester

### ููู ูุนูู ุงุฎุชุจุงุฑ ุงูุงุณุชุฑุงุชูุฌูุงุช ุนุจุฑ ููู .iniุ

MT5 ูุง ูุฏุนู ุชุดุบูู Strategy Tester ูุจุงุดุฑุฉ ูู Python APIุ ูุฐูู ูุณุชุฎุฏู ุทุฑููุฉ ุจุฏููุฉ ุฐููุฉ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         ุณูุฑ ุงูุนูู                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                 โ
โ   1. ุทูุจ API โโโโโโโบ 2. ุฅูุดุงุก ููู .ini โโโโโโโบ 3. ุชุดุบูู MT5    โ
โ                           โ                         โ           โ
โ                           โผ                         โผ           โ
โ                    [test_config.ini]      [terminal64.exe]      โ
โ                           โ                    /config:         โ
โ                           โ                         โ           โ
โ                           โโโโโโโโโโโโโโโโโโโโโโโโโโโ           โ
โ                                    โ                            โ
โ                                    โผ                            โ
โ                           4. Strategy Tester                    โ
โ                                    โ                            โ
โ                                    โผ                            โ
โ                           5. ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ                     โ
โ                                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ูููู ููู ุงูุชูููู (.ini)

```ini
[Tester]
; === ุงููุณุชุดุงุฑ ุงูุฎุจูุฑ ===
Expert=ExpertMACD
ExpertParameters=

; === ุงูุฑูุฒ ูุงูุฅุทุงุฑ ุงูุฒููู ===
Symbol=EURUSD
Period=H1

; === ูุชุฑุฉ ุงูุงุฎุชุจุงุฑ ===
FromDate=2024.01.01
ToDate=2024.06.30

; === ููุน ุงูููุฐุฌุฉ ===
; 0 = ูู ุชูู (Every tick) - ุฃุนูู ุฏูุฉ
; 1 = ููุงุท ุงูุชุญูู (1 minute OHLC)
; 2 = ุฃุณุนุงุฑ ุงูุงูุชุชุงุญ ููุท (Open prices only) - ุฃุณุฑุน
Model=0

; === ุงูุชุญุณูู ===
; 0 = ูุนุทู
; 1 = ุจุทูุก (ูุงูู)
; 2 = ุฎูุงุฑุฒููุฉ ุฌูููุฉ
Optimization=0

; === ุฅุนุฏุงุฏุงุช ุฃุฎุฑู ===
Visual=0
Deposit=10000
Leverage=100
Currency=USD

; === ุฅุบูุงู MT5 ุจุนุฏ ุงูุงูุชูุงุก ===
ShutdownTerminal=1
```

### ุฃูุฑ ุงูุชุดุบูู

```bash
terminal64.exe /config:C:\path\to\test_config.ini
```

---

## ๐ ูููู ุงููุดุฑูุน

```
mt5_middleware/
โโโ main.py              # ุงูููู ุงูุฑุฆูุณู ููุฎุงุฏู
โโโ requirements.txt     # ุงููุชุทูุจุงุช
โโโ README.md           # ูุฐุง ุงูููู
โโโ configs/            # ูุฌูุฏ ูููุงุช ุงูุชูููู (ูููุดุฃ ุชููุงุฆูุงู)
โ   โโโ backtest_*.ini
โโโ mt5_server.log      # ุณุฌู ุงูุฃุญุฏุงุซ
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. ูุณุงุฑ terminal64.exe

ุนุงุฏุฉู ูููู ูู ุฃุญุฏ ูุฐู ุงููุณุงุฑุงุช:
```
C:\Program Files\MetaTrader 5\terminal64.exe
C:\Program Files (x86)\MetaTrader 5\terminal64.exe
```

### 2. ูุณุงุฑ ูุฌูุฏ MQL5

ููุนุซูุฑ ุนููู:
1. ุงูุชุญ MT5
2. ุงุถุบุท `File` > `Open Data Folder`
3. ุณุชุฌุฏ ูุฌูุฏ `MQL5`

ุงููุณุงุฑ ุงููููุฐุฌู:
```
C:\Users\USERNAME\AppData\Roaming\MetaQuotes\Terminal\XXXX\MQL5
```

### 3. ุงููุณุชุดุงุฑูู ุงูุฎุจุฑุงุก

ูุฌุจ ุฃู ูููู EA:
- ูุชุฑุฌูุงู (ููู .ex5)
- ููุฌูุฏุงู ูู `MQL5/Experts`
- ูุง ุชูุชุจ ุงูุงูุชุฏุงุฏ (.ex5) ูู ุงูุทูุจ

### 4. ุงูุชุดุบูู ุนูู Windows ููุท

ููุชุจุฉ `MetaTrader5` ุงูุฑุณููุฉ ุชุนูู ููุท ุนูู Windows. ุนูู ุฃูุธูุฉ ุฃุฎุฑูุ ุงูุฎุงุฏู ูุนูู ูู "ูุถุน ุงููุญุงูุงุฉ" ููุงุฎุชุจุงุฑ.

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "ููู terminal64.exe ุบูุฑ ููุฌูุฏ"
- ุชุฃูุฏ ูู ุตุญุฉ ุงููุณุงุฑ
- ุงุณุชุฎุฏู `/` ุจุฏูุงู ูู `\` ูู ุงููุณุงุฑ

### ุฎุทุฃ: "ูุดู ุงูุงุชุตุงู ุจู MT5"
- ุชุฃูุฏ ูู ุฃู MT5 ูุซุจุช ููููุนูู
- ุชุฃูุฏ ูู ุตุญุฉ ุจูุงูุงุช ุงูุฏุฎูู
- ุชุฃูุฏ ูู ุฃู MT5 ุบูุฑ ููุชูุญ ูุณุจูุงู

### ุฎุทุฃ: "ุงููุณุชุดุงุฑ ุงูุฎุจูุฑ ุบูุฑ ููุฌูุฏ"
- ุชุฃูุฏ ูู ุฃู EA ูุชุฑุฌู (ููู .ex5)
- ุชุฃูุฏ ูู ุงููุณุงุฑ ุงูุตุญูุญ ูู MQL5/Experts

---

## ๐ ุงุณุชุฎุฏุงู CORS

ุงูุฎุงุฏู ููุนุฏ ููุณูุงุญ ุจุงูุงุชุตุงู ูู ุฃู ูุตุฏุฑ. ูู ุงูุฅูุชุงุฌุ ุนุฏูู ูุฐุง:

```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=["https://your-domain.com"],  # ุญุฏุฏ ุงููุทุงูุงุช ุงููุณููุญุฉ
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

---

## ๐ ุฃูุซูุฉ ุจู Python

### ูุซุงู 1: ุงูุงุชุตุงู ูุงูุญุตูู ุนูู ูุนูููุงุช ุงูุญุณุงุจ

```python
import requests

BASE_URL = "http://localhost:8000"

# ุงูุงุชุตุงู
response = requests.post(f"{BASE_URL}/connect", json={
    "terminal_path": "C:/Program Files/MetaTrader 5/terminal64.exe",
    "login": 12345678,
    "password": "your_password",
    "server": "YourBroker-Server"
})
print(response.json())

# ูุนูููุงุช ุงูุญุณุงุจ
response = requests.get(f"{BASE_URL}/account_info")
print(response.json())

# ูุทุน ุงูุงุชุตุงู
response = requests.post(f"{BASE_URL}/disconnect")
print(response.json())
```

### ูุซุงู 2: ุชุดุบูู Backtest

```python
import requests

response = requests.post("http://localhost:8000/run_backtest", json={
    "terminal_path": "C:/Program Files/MetaTrader 5/terminal64.exe",
    "expert_advisor": "ExpertMACD",
    "symbol": "EURUSD",
    "period": "H1",
    "from_date": "2024.01.01",
    "to_date": "2024.06.30",
    "deposit": 10000,
    "model": 0
})
print(response.json())
```

### ูุซุงู 3: ุงุณุชุฎุฏุงู JavaScript (ูู ุชุทุจูู ููุจ)

```javascript
// ุงูุงุชุตุงู ุจู MT5
const response = await fetch('http://localhost:8000/connect', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        terminal_path: 'C:/Program Files/MetaTrader 5/terminal64.exe'
    })
});

const data = await response.json();
console.log(data);
```

---

## ๐ ุงูุฃูุงู

โ๏ธ **ุชุญุฐูุฑุงุช ุฃูููุฉ:**

1. **ูุง ุชุดุงุฑู ุจูุงูุงุช ุงูุฏุฎูู** ูู ุงูููุฏ
2. **ุงุณุชุฎุฏู ูุชุบูุฑุงุช ุงูุจูุฆุฉ** ูุชุฎุฒูู ูููุงุช ุงููุฑูุฑ
3. **ูููุฏ CORS** ูู ุงูุฅูุชุงุฌ
4. **ุงุณุชุฎุฏู HTTPS** ููุงุชุตุงูุงุช ุงูุฎุงุฑุฌูุฉ
5. **ูุง ุชุนุฑุถ ุงูุฎุงุฏู ููุฅูุชุฑูุช** ูุจุงุดุฑุฉ

---

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ููุฃุบุฑุงุถ ุงูุชุนููููุฉ. ุงุณุชุฎุฏูู ุนูู ูุณุคูููุชู ุงูุฎุงุตุฉ.

---

## ๐ค ุงููุณุงููุฉ

ูุฑุญุจ ุจูุณุงููุงุชูู! ุงูุชุญ Issue ุฃู Pull Request.

---

<div align="center">

**ุตููุน ุจู โค๏ธ ูููุชุฏุงูููู ุงูุนุฑุจ**

</div>

</div>
